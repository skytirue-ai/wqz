import{B as e,G as t,H as n,K as r,U as i,V as a,W as o,_ as s,a as c,b as l,c as u,d,f,g as p,h as m,i as h,l as g,m as _,o as v,p as y,q as b,s as x,t as S,u as C,v as w,x as T,y as E,z as D}from"./index-CG3uUGt1.js";var O=class extends D{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,n(e);let r=b(t);if(this.iHash=e.create(),typeof this.iHash.update!=`function`)throw Error(`Expected instance of class which extends utils.Hash`);this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,a=new Uint8Array(i);a.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<a.length;e++)a[e]^=54;this.iHash.update(a),this.oHash=e.create();for(let e=0;e<a.length;e++)a[e]^=106;this.oHash.update(a),o(a)}update(e){return a(this),this.iHash.update(e),this}digestInto(t){a(this),e(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});let{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:a,outputLen:o}=this;return e=e,e.finished=r,e.destroyed=i,e.blockLen=a,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const k=(e,t,n)=>new O(e,t).update(n).digest();k.create=(e,t)=>new O(e,t);var A=BigInt(0),j=BigInt(1),M=BigInt(2),N=BigInt(3),P=BigInt(4),F=BigInt(5),I=BigInt(8);function L(e,t){let n=e%t;return n>=A?n:t+n}function R(e,t,n){let r=e;for(;t-- >A;)r*=r,r%=n;return r}function z(e,t){if(e===A)throw Error(`invert: expected non-zero number`);if(t<=A)throw Error(`invert: expected positive modulus, got `+t);let n=L(e,t),r=t,i=A,a=j,o=j,s=A;for(;n!==A;){let e=r/n,t=r%n,c=i-o*e,l=a-s*e;r=n,n=t,i=o,a=s,o=c,s=l}if(r!==j)throw Error(`invert: does not exist`);return L(i,t)}function B(e,t){let n=(e.ORDER+j)/P,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw Error(`Cannot find square root`);return r}function ee(e,t){let n=(e.ORDER-F)/I,r=e.mul(t,M),i=e.pow(r,n),a=e.mul(t,i),o=e.mul(e.mul(a,M),i),s=e.mul(a,e.sub(o,e.ONE));if(!e.eql(e.sqr(s),t))throw Error(`Cannot find square root`);return s}function te(e){if(e<BigInt(3))throw Error(`sqrt is not defined for small field`);let t=e-j,n=0;for(;t%M===A;)t/=M,n++;let r=M,i=V(e);for(;se(i,r)===1;)if(r++>1e3)throw Error(`Cannot find square root: probably non-prime P`);if(n===1)return B;let a=i.pow(r,t),o=(t+j)/M;return function(e,r){if(e.is0(r))return r;if(se(e,r)!==1)throw Error(`Cannot find square root`);let i=n,s=e.mul(e.ONE,a),c=e.pow(r,t),l=e.pow(r,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,n=e.sqr(c);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===i)throw Error(`Cannot find square root`);let r=j<<BigInt(i-t-1),a=e.pow(s,r);i=t,s=e.sqr(a),c=e.mul(c,s),l=e.mul(l,a)}return l}}function ne(e){return e%P===N?B:e%I===F?ee:te(e)}var re=[`create`,`isValid`,`is0`,`neg`,`inv`,`sqrt`,`sqr`,`eql`,`add`,`sub`,`mul`,`pow`,`div`,`addN`,`subN`,`mulN`,`sqrN`];function ie(e){let t=re.reduce((e,t)=>(e[t]=`function`,e),{ORDER:`bigint`,MASK:`bigint`,BYTES:`isSafeInteger`,BITS:`isSafeInteger`});return T(e,t)}function ae(e,t,n){if(n<A)throw Error(`invalid exponent, negatives unsupported`);if(n===A)return e.ONE;if(n===j)return t;let r=e.ONE,i=t;for(;n>A;)n&j&&(r=e.mul(r,i)),i=e.sqr(i),n>>=j;return r}function oe(e,t,n=!1){let r=Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n)),e.ONE),a=e.inv(i);return t.reduceRight((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n)),a),r}function se(e,t){let n=(e.ORDER-j)/M,r=e.pow(t,n),i=e.eql(r,e.ONE),a=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!i&&!a&&!o)throw Error(`invalid Legendre symbol result`);return i?1:a?0:-1}function ce(e,t){t!==void 0&&i(t);let n=t===void 0?e.toString(2).length:t,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function V(e,t,n=!1,r={}){if(e<=A)throw Error(`invalid field: expected ORDER > 0, got `+e);let{nBitLength:i,nByteLength:a}=ce(e,t);if(a>2048)throw Error(`invalid field: expected ORDER of <= 2048 bytes`);let o,s=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:a,MASK:x(i),ZERO:A,ONE:j,create:t=>L(t,e),isValid:t=>{if(typeof t!=`bigint`)throw Error(`invalid field element: expected bigint, got `+typeof t);return A<=t&&t<e},is0:e=>e===A,isOdd:e=>(e&j)===j,neg:t=>L(-t,e),eql:(e,t)=>e===t,sqr:t=>L(t*t,e),add:(t,n)=>L(t+n,e),sub:(t,n)=>L(t-n,e),mul:(t,n)=>L(t*n,e),pow:(e,t)=>ae(s,e,t),div:(t,n)=>L(t*z(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>z(t,e),sqrt:r.sqrt||(t=>(o||=ne(e),o(s,t))),toBytes:e=>n?E(e,a):w(e,a),fromBytes:e=>{if(e.length!==a)throw Error(`Field.fromBytes: expected `+a+` bytes, got `+e.length);return n?C(e):g(e)},invertBatch:e=>oe(s,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(s)}function le(e){if(typeof e!=`bigint`)throw Error(`field order must be bigint`);let t=e.toString(2).length;return Math.ceil(t/8)}function ue(e){let t=le(e);return t+Math.ceil(t/2)}function de(e,t,n=!1){let r=e.length,i=le(t),a=ue(t);if(r<16||r<a||r>1024)throw Error(`expected `+a+`-1024 bytes of input, got `+r);let o=n?C(e):g(e),s=L(o,t-j)+j;return n?E(s,i):w(s,i)}var fe=BigInt(0),H=BigInt(1);function U(e,t){let n=t.negate();return e?n:t}function pe(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error(`invalid window size, expected [1..`+t+`], got W=`+e)}function W(e,t){pe(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),i=2**e,a=x(e),o=BigInt(e);return{windows:n,windowSize:r,mask:a,maxNumber:i,shiftBy:o}}function me(e,t,n){let{windowSize:r,mask:i,maxNumber:a,shiftBy:o}=n,s=Number(e&i),c=e>>o;s>r&&(s-=a,c+=H);let l=t*r,u=l+Math.abs(s)-1,d=s===0,f=s<0,p=t%2!=0;return{nextN:c,offset:u,isZero:d,isNeg:f,isNegF:p,offsetF:l}}function he(e,t){if(!Array.isArray(e))throw Error(`array expected`);e.forEach((e,n)=>{if(!(e instanceof t))throw Error(`invalid point at index `+n)})}function ge(e,t){if(!Array.isArray(e))throw Error(`array of scalars expected`);e.forEach((e,n)=>{if(!t.isValid(e))throw Error(`invalid scalar at index `+n)})}var G=new WeakMap,_e=new WeakMap;function K(e){return _e.get(e)||1}function ve(e,t){return{constTimeNegate:U,hasPrecomputes(e){return K(e)!==1},unsafeLadder(t,n,r=e.ZERO){let i=t;for(;n>fe;)n&H&&(r=r.add(i)),i=i.double(),n>>=H;return r},precomputeWindow(e,n){let{windows:r,windowSize:i}=W(n,t),a=[],o=e,s=o;for(let e=0;e<r;e++){s=o,a.push(s);for(let e=1;e<i;e++)s=s.add(o),a.push(s);o=s.double()}return a},wNAF(n,r,i){let a=e.ZERO,o=e.BASE,s=W(n,t);for(let e=0;e<s.windows;e++){let{nextN:t,offset:n,isZero:c,isNeg:l,isNegF:u,offsetF:d}=me(i,e,s);i=t,c?o=o.add(U(u,r[d])):a=a.add(U(l,r[n]))}return{p:a,f:o}},wNAFUnsafe(n,r,i,a=e.ZERO){let o=W(n,t);for(let e=0;e<o.windows&&i!==fe;e++){let{nextN:t,offset:n,isZero:s,isNeg:c}=me(i,e,o);if(i=t,!s){let e=r[n];a=a.add(c?e.negate():e)}}return a},getPrecomputes(e,t,n){let r=G.get(t);return r||(r=this.precomputeWindow(t,e),e!==1&&G.set(t,n(r))),r},wNAFCached(e,t,n){let r=K(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){let i=K(e);return i===1?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize(e,n){pe(n,t),_e.set(e,n),G.delete(e)}}}function ye(e,t,n,r){he(n,e),ge(r,t);let i=n.length,a=r.length;if(i!==a)throw Error(`arrays of points and scalars must have equal length`);let o=e.ZERO,s=v(BigInt(i)),c=1;s>12?c=s-3:s>4?c=s-2:s>0&&(c=2);let l=x(c),u=Array(Number(l)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c,f=o;for(let e=d;e>=0;e-=c){u.fill(o);for(let t=0;t<a;t++){let i=r[t],a=Number(i>>BigInt(e)&l);u[a]=u[a].add(n[t])}let t=o;for(let e=u.length-1,n=o;e>0;e--)n=n.add(u[e]),t=t.add(n);if(f=f.add(t),e!==0)for(let e=0;e<c;e++)f=f.double()}return f}function be(e){return ie(e.Fp),T(e,{n:`bigint`,h:`bigint`,Gx:`field`,Gy:`field`},{nBitLength:`isSafeInteger`,nByteLength:`isSafeInteger`}),Object.freeze({...ce(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function xe(e){e.lowS!==void 0&&c(`lowS`,e.lowS),e.prehash!==void 0&&c(`prehash`,e.prehash)}function Se(e){let t=be(e);T(t,{a:`field`,b:`field`},{allowInfinityPoint:`boolean`,allowedPrivateKeyLengths:`array`,clearCofactor:`function`,fromBytes:`function`,isTorsionFree:`function`,toBytes:`function`,wrapPrivateKey:`boolean`});let{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw Error(`invalid endo: CURVE.a must be 0`);if(typeof n!=`object`||typeof n.beta!=`bigint`||typeof n.splitScalar!=`function`)throw Error(`invalid endo: expected "beta": bigint and "splitScalar": function`)}return Object.freeze({...t})}const q={Err:class extends Error{constructor(e=``){super(e)}},_tlv:{encode:(e,t)=>{let{Err:n}=q;if(e<0||e>256)throw new n(`tlv.encode: wrong tag`);if(t.length&1)throw new n(`tlv.encode: unpadded data`);let r=t.length/2,i=l(r);if(i.length/2&128)throw new n(`tlv.encode: long form length too big`);let a=r>127?l(i.length/2|128):``;return l(e)+a+i+t},decode(e,t){let{Err:n}=q,r=0;if(e<0||e>256)throw new n(`tlv.encode: wrong tag`);if(t.length<2||t[r++]!==e)throw new n(`tlv.decode: wrong tlv`);let i=t[r++],a=!!(i&128),o=0;if(!a)o=i;else{let e=i&127;if(!e)throw new n(`tlv.decode(long): indefinite length not supported`);if(e>4)throw new n(`tlv.decode(long): byte length is too big`);let a=t.subarray(r,r+e);if(a.length!==e)throw new n(`tlv.decode: length bytes not complete`);if(a[0]===0)throw new n(`tlv.decode(long): zero leftmost byte`);for(let e of a)o=o<<8|e;if(r+=e,o<128)throw new n(`tlv.decode(long): not minimal encoding`)}let s=t.subarray(r,r+o);if(s.length!==o)throw new n(`tlv.decode: wrong value length`);return{v:s,l:t.subarray(r+o)}}},_int:{encode(e){let{Err:t}=q;if(e<Y)throw new t(`integer: negative integers are not allowed`);let n=l(e);if(Number.parseInt(n[0],16)&8&&(n=`00`+n),n.length&1)throw new t(`unexpected DER parsing assertion: unpadded hex`);return n},decode(e){let{Err:t}=q;if(e[0]&128)throw new t(`invalid signature integer: negative`);if(e[0]===0&&!(e[1]&128))throw new t(`invalid signature integer: unnecessary leading zero`);return g(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=q,i=y(`signature`,e),{v:a,l:o}=r.decode(48,i);if(o.length)throw new t(`invalid signature: left bytes after parsing`);let{v:s,l:c}=r.decode(2,a),{v:l,l:u}=r.decode(2,c);if(u.length)throw new t(`invalid signature: left bytes after parsing`);return{r:n.decode(s),s:n.decode(l)}},hexFromSig(e){let{_tlv:t,_int:n}=q,r=t.encode(2,n.encode(e.r)),i=t.encode(2,n.encode(e.s)),a=r+i;return t.encode(48,a)}};function J(e,t){return u(w(e,t))}var Y=BigInt(0),X=BigInt(1);BigInt(2);var Z=BigInt(3),Ce=BigInt(4);function we(e){let t=Se(e),{Fp:n}=t,r=V(t.n,t.nBitLength),i=t.toBytes||((e,t,r)=>{let i=t.toAffine();return d(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),a=t.fromBytes||(e=>{let t=e.subarray(1),r=n.fromBytes(t.subarray(0,n.BYTES)),i=n.fromBytes(t.subarray(n.BYTES,2*n.BYTES));return{x:r,y:i}});function o(e){let{a:r,b:i}=t,a=n.sqr(e),o=n.mul(a,e);return n.add(n.add(o,n.mul(e,r)),i)}function l(e,t){let r=n.sqr(t),i=o(e);return n.eql(r,i)}if(!l(t.Gx,t.Gy))throw Error(`bad curve params: generator point`);let f=n.mul(n.pow(t.a,Z),Ce),_=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(f,_)))throw Error(`bad curve params: a or b`);function v(e){return m(e,X,t.n)}function b(e){let{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:a}=t;if(n&&typeof e!=`bigint`){if(p(e)&&(e=u(e)),typeof e!=`string`||!n.includes(e.length))throw Error(`invalid private key`);e=e.padStart(r*2,`0`)}let o;try{o=typeof e==`bigint`?e:g(y(`private key`,e,r))}catch{throw Error(`invalid private key, expected hex or `+r+` bytes, got `+typeof e)}return i&&(o=L(o,a)),h(`private key`,o,X,a),o}function x(e){if(!(e instanceof w))throw Error(`ProjectivePoint expected`)}let S=s((e,t)=>{let{px:r,py:i,pz:a}=e;if(n.eql(a,n.ONE))return{x:r,y:i};let o=e.is0();t??=o?n.ONE:n.inv(a);let s=n.mul(r,t),c=n.mul(i,t),l=n.mul(a,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw Error(`invZ was invalid`);return{x:s,y:c}}),C=s(e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw Error(`bad point: ZERO`)}let{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw Error(`bad point: x or y not FE`);if(!l(r,i))throw Error(`bad point: equation left != right`);if(!e.isTorsionFree())throw Error(`bad point: not in prime-order subgroup`);return!0});class w{constructor(e,t,r){if(e==null||!n.isValid(e))throw Error(`x required`);if(t==null||!n.isValid(t)||n.is0(t))throw Error(`y required`);if(r==null||!n.isValid(r))throw Error(`z required`);this.px=e,this.py=t,this.pz=r,Object.freeze(this)}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw Error(`invalid affine point`);if(e instanceof w)throw Error(`projective point not allowed`);let i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?w.ZERO:new w(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=oe(n,e.map(e=>e.pz));return e.map((e,n)=>e.toAffine(t[n])).map(w.fromAffine)}static fromHex(e){let t=w.fromAffine(a(y(`pointHex`,e)));return t.assertValidity(),t}static fromPrivateKey(e){return w.BASE.multiply(b(e))}static msm(e,t){return ye(w,r,e,t)}_setWindowSize(e){D.setWindowSize(this,e)}assertValidity(){C(this)}hasEvenY(){let{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw Error(`Field doesn't support isOdd`)}equals(e){x(e);let{px:t,py:r,pz:i}=this,{px:a,py:o,pz:s}=e,c=n.eql(n.mul(t,s),n.mul(a,i)),l=n.eql(n.mul(r,s),n.mul(o,i));return c&&l}negate(){return new w(this.px,n.neg(this.py),this.pz)}double(){let{a:e,b:r}=t,i=n.mul(r,Z),{px:a,py:o,pz:s}=this,c=n.ZERO,l=n.ZERO,u=n.ZERO,d=n.mul(a,a),f=n.mul(o,o),p=n.mul(s,s),m=n.mul(a,o);return m=n.add(m,m),u=n.mul(a,s),u=n.add(u,u),c=n.mul(e,u),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(m,c),u=n.mul(i,u),p=n.mul(e,p),m=n.sub(d,p),m=n.mul(e,m),m=n.add(m,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,p),d=n.mul(d,m),l=n.add(l,d),p=n.mul(o,s),p=n.add(p,p),d=n.mul(p,m),c=n.sub(c,d),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new w(c,l,u)}add(e){x(e);let{px:r,py:i,pz:a}=this,{px:o,py:s,pz:c}=e,l=n.ZERO,u=n.ZERO,d=n.ZERO,f=t.a,p=n.mul(t.b,Z),m=n.mul(r,o),h=n.mul(i,s),g=n.mul(a,c),_=n.add(r,i),v=n.add(o,s);_=n.mul(_,v),v=n.add(m,h),_=n.sub(_,v),v=n.add(r,a);let y=n.add(o,c);return v=n.mul(v,y),y=n.add(m,g),v=n.sub(v,y),y=n.add(i,a),l=n.add(s,c),y=n.mul(y,l),l=n.add(h,g),y=n.sub(y,l),d=n.mul(f,v),l=n.mul(p,g),d=n.add(l,d),l=n.sub(h,d),d=n.add(h,d),u=n.mul(l,d),h=n.add(m,m),h=n.add(h,m),g=n.mul(f,g),v=n.mul(p,v),h=n.add(h,g),g=n.sub(m,g),g=n.mul(f,g),v=n.add(v,g),m=n.mul(h,v),u=n.add(u,m),m=n.mul(y,v),l=n.mul(_,l),l=n.sub(l,m),m=n.mul(_,h),d=n.mul(y,d),d=n.add(d,m),new w(l,u,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(w.ZERO)}wNAF(e){return D.wNAFCached(this,e,w.normalizeZ)}multiplyUnsafe(e){let{endo:r,n:i}=t;h(`scalar`,e,Y,i);let a=w.ZERO;if(e===Y)return a;if(this.is0()||e===X)return this;if(!r||D.hasPrecomputes(this))return D.wNAFCachedUnsafe(this,e,w.normalizeZ);let{k1neg:o,k1:s,k2neg:c,k2:l}=r.splitScalar(e),u=a,d=a,f=this;for(;s>Y||l>Y;)s&X&&(u=u.add(f)),l&X&&(d=d.add(f)),f=f.double(),s>>=X,l>>=X;return o&&(u=u.negate()),c&&(d=d.negate()),d=new w(n.mul(d.px,r.beta),d.py,d.pz),u.add(d)}multiply(e){let{endo:r,n:i}=t;h(`scalar`,e,X,i);let a,o;if(r){let{k1neg:t,k1:i,k2neg:s,k2:c}=r.splitScalar(e),{p:l,f:u}=this.wNAF(i),{p:d,f}=this.wNAF(c);l=D.constTimeNegate(t,l),d=D.constTimeNegate(s,d),d=new w(n.mul(d.px,r.beta),d.py,d.pz),a=l.add(d),o=u.add(f)}else{let{p:t,f:n}=this.wNAF(e);a=t,o=n}return w.normalizeZ([a,o])[0]}multiplyAndAddUnsafe(e,t,n){let r=w.BASE,i=(e,t)=>t===Y||t===X||!e.equals(r)?e.multiplyUnsafe(t):e.multiply(t),a=i(this,t).add(i(e,n));return a.is0()?void 0:a}toAffine(e){return S(this,e)}isTorsionFree(){let{h:e,isTorsionFree:n}=t;if(e===X)return!0;if(n)return n(w,this);throw Error(`isTorsionFree() has not been declared for the elliptic curve`)}clearCofactor(){let{h:e,clearCofactor:n}=t;return e===X?this:n?n(w,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return c(`isCompressed`,e),this.assertValidity(),i(w,this,e)}toHex(e=!0){return c(`isCompressed`,e),u(this.toRawBytes(e))}}w.BASE=new w(t.Gx,t.Gy,n.ONE),w.ZERO=new w(n.ZERO,n.ONE,n.ZERO);let{endo:T,nBitLength:E}=t,D=ve(w,T?Math.ceil(E/2):E);return{CURVE:t,ProjectivePoint:w,normPrivateKeyToScalar:b,weierstrassEquation:o,isWithinCurveOrder:v}}function Te(e){let t=be(e);return T(t,{hash:`hash`,hmac:`function`,randomBytes:`function`},{bits2int:`function`,bits2int_modN:`function`,lowS:`boolean`}),Object.freeze({lowS:!0,...t})}function Ee(e){let t=Te(e),{Fp:n,n:r,nByteLength:i,nBitLength:a}=t,o=n.BYTES+1,s=2*n.BYTES+1;function l(e){return L(e,r)}function u(e){return z(e,r)}let{ProjectivePoint:v,normPrivateKeyToScalar:b,weierstrassEquation:S,isWithinCurveOrder:C}=we({...t,toBytes(e,t,r){let i=t.toAffine(),a=n.toBytes(i.x),o=d;return c(`isCompressed`,r),r?o(Uint8Array.from([t.hasEvenY()?2:3]),a):o(Uint8Array.from([4]),a,n.toBytes(i.y))},fromBytes(e){let t=e.length,r=e[0],i=e.subarray(1);if(t===o&&(r===2||r===3)){let e=g(i);if(!m(e,X,n.ORDER))throw Error(`Point is not on curve`);let t=S(e),a;try{a=n.sqrt(t)}catch(e){let t=e instanceof Error?`: `+e.message:``;throw Error(`Point is not on curve`+t)}let o=(a&X)===X;return(r&1)==1!==o&&(a=n.neg(a)),{x:e,y:a}}else if(t===s&&r===4){let e=n.fromBytes(i.subarray(0,n.BYTES)),t=n.fromBytes(i.subarray(n.BYTES,2*n.BYTES));return{x:e,y:t}}else{let e=o,n=s;throw Error(`invalid Point, expected length of `+e+`, or uncompressed `+n+`, got `+t)}}});function T(e){let t=r>>X;return e>t}function E(e){return T(e)?l(-e):e}let D=(e,t,n)=>g(e.slice(t,n));class O{constructor(e,t,n){h(`r`,e,X,r),h(`s`,t,X,r),this.r=e,this.s=t,n!=null&&(this.recovery=n),Object.freeze(this)}static fromCompact(e){let t=i;return e=y(`compactSignature`,e,t*2),new O(D(e,0,t),D(e,t,2*t))}static fromDER(e){let{r:t,s:n}=q.toSig(y(`DER`,e));return new O(t,n)}assertValidity(){}addRecoveryBit(e){return new O(this.r,this.s,e)}recoverPublicKey(e){let{r,s:i,recovery:a}=this,o=P(y(`msgHash`,e));if(a==null||![0,1,2,3].includes(a))throw Error(`recovery id invalid`);let s=a===2||a===3?r+t.n:r;if(s>=n.ORDER)throw Error(`recovery id 2 or 3 invalid`);let c=a&1?`03`:`02`,d=v.fromHex(c+J(s,n.BYTES)),f=u(s),p=l(-o*f),m=l(i*f),h=v.BASE.multiplyAndAddUnsafe(d,p,m);if(!h)throw Error(`point at infinify`);return h.assertValidity(),h}hasHighS(){return T(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return _(this.toDERHex())}toDERHex(){return q.hexFromSig(this)}toCompactRawBytes(){return _(this.toCompactHex())}toCompactHex(){let e=i;return J(this.r,e)+J(this.s,e)}}let k={isValidPrivateKey(e){try{return b(e),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{let e=ue(t.n);return de(t.randomBytes(e),t.n)},precompute(e=8,t=v.BASE){return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function A(e,t=!0){return v.fromPrivateKey(e).toRawBytes(t)}function j(e){if(typeof e==`bigint`)return!1;if(e instanceof v)return!0;let r=y(`key`,e).length,a=n.BYTES,o=a+1,s=2*a+1;if(!(t.allowedPrivateKeyLengths||i===o))return r===o||r===s}function M(e,t,n=!0){if(j(e)===!0)throw Error(`first arg must be private key`);if(j(t)===!1)throw Error(`second arg must be public key`);return v.fromHex(t).multiply(b(e)).toRawBytes(n)}let N=t.bits2int||function(e){if(e.length>8192)throw Error(`input is too large`);let t=g(e),n=e.length*8-a;return n>0?t>>BigInt(n):t},P=t.bits2int_modN||function(e){return l(N(e))},F=x(a);function I(e){return h(`num < 2^`+a,e,Y,F),w(e,i)}function R(e,r,i=B){if([`recovered`,`canonical`].some(e=>e in i))throw Error(`sign() legacy options not supported`);let{hash:a,randomBytes:o}=t,{lowS:s,prehash:c,extraEntropy:f}=i;s??=!0,e=y(`msgHash`,e),xe(i),c&&(e=y(`prehashed msgHash`,a(e)));let p=P(e),m=b(r),h=[I(m),I(p)];if(f!=null&&f!==!1){let e=f===!0?o(n.BYTES):f;h.push(y(`extraEntropy`,e))}let g=d(...h),_=p;function x(e){let t=N(e);if(!C(t))return;let n=u(t),r=v.BASE.multiply(t).toAffine(),i=l(r.x);if(i===Y)return;let a=l(n*l(_+i*m));if(a===Y)return;let o=(r.x===i?0:2)|Number(r.y&X),c=a;return s&&T(a)&&(c=E(a),o^=1),new O(i,c,o)}return{seed:g,k2sig:x}}let B={lowS:t.lowS,prehash:!1},ee={lowS:t.lowS,prehash:!1};function te(e,n,r=B){let{seed:i,k2sig:a}=R(e,n,r),o=t;return f(o.hash.outputLen,o.nByteLength,o.hmac)(i,a)}v.BASE._setWindowSize(8);function ne(e,n,r,i=ee){let a=e;n=y(`msgHash`,n),r=y(`publicKey`,r);let{lowS:o,prehash:s,format:c}=i;if(xe(i),`strict`in i)throw Error(`options.strict was renamed to lowS`);if(c!==void 0&&c!==`compact`&&c!==`der`)throw Error(`format must be compact or der`);let d=typeof a==`string`||p(a),f=!d&&!c&&typeof a==`object`&&!!a&&typeof a.r==`bigint`&&typeof a.s==`bigint`;if(!d&&!f)throw Error(`invalid signature, expected Uint8Array, hex string or Signature instance`);let m,h;try{if(f&&(m=new O(a.r,a.s)),d){try{c!==`compact`&&(m=O.fromDER(a))}catch(e){if(!(e instanceof q.Err))throw e}!m&&c!==`der`&&(m=O.fromCompact(a))}h=v.fromHex(r)}catch{return!1}if(!m||o&&m.hasHighS())return!1;s&&(n=t.hash(n));let{r:g,s:_}=m,b=P(n),x=u(_),S=l(b*x),C=l(g*x),w=v.BASE.multiplyAndAddUnsafe(h,S,C)?.toAffine();return w?l(w.x)===g:!1}return{CURVE:t,getPublicKey:A,getSharedSecret:M,sign:te,verify:ne,ProjectivePoint:v,Signature:O,utils:k}}function De(e){return{hash:e,hmac:(n,...r)=>k(e,n,t(...r)),randomBytes:r}}function Oe(e,t){let n=t=>Ee({...e,...De(t)});return{...n(t),create:n}}var ke=BigInt(`0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f`),Ae=BigInt(`0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141`),je=BigInt(0),Me=BigInt(1),Q=BigInt(2),Ne=(e,t)=>(e+t/Q)/t;function Pe(e){let t=ke,n=BigInt(3),r=BigInt(6),i=BigInt(11),a=BigInt(22),o=BigInt(23),s=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,d=R(u,n,t)*u%t,f=R(d,n,t)*u%t,p=R(f,Q,t)*l%t,m=R(p,i,t)*p%t,h=R(m,a,t)*m%t,g=R(h,s,t)*h%t,_=R(g,c,t)*g%t,v=R(_,s,t)*h%t,y=R(v,n,t)*u%t,b=R(y,o,t)*m%t,x=R(b,r,t)*l%t,S=R(x,Q,t);if(!$.eql($.sqr(S),e))throw Error(`Cannot find square root`);return S}var $=V(ke,void 0,void 0,{sqrt:Pe});const Fe=Oe({a:je,b:BigInt(7),Fp:$,n:Ae,Gx:BigInt(`55066263022277343669578718895168534326250603453777594175500187360389116729240`),Gy:BigInt(`32670510020758816978083085130507043184471273380659243275938904335757337482424`),h:BigInt(1),lowS:!0,endo:{beta:BigInt(`0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee`),splitScalar:e=>{let t=Ae,n=BigInt(`0x3086d221a7d46bcde86c90e49284eb15`),r=-Me*BigInt(`0xe4437ed6010e88286f547fa90abfe4c3`),i=BigInt(`0x114ca50f7a8e2f3f657c1108d9d44cfd8`),a=n,o=BigInt(`0x100000000000000000000000000000000`),s=Ne(a*e,t),c=Ne(-r*e,t),l=L(e-s*n-c*i,t),u=L(-s*r-c*a,t),d=l>o,f=u>o;if(d&&(l=t-l),f&&(u=t-u),l>o||u>o)throw Error(`splitScalar: Endomorphism failed, k=`+e);return{k1neg:d,k1:l,k2neg:f,k2:u}}}},S);export{Fe as secp256k1};