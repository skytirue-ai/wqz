!function(){function r(r,t){var n="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,t){if(r){if("string"==typeof r)return e(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}(r))||t&&r&&"number"==typeof r.length){n&&(r=n);var i=0,o=function(){};return{s:o,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,f=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return s=r.done,r},e:function(r){f=!0,a=r},f:function(){try{s||null==n.return||n.return()}finally{if(f)throw a}}}}function e(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function t(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function n(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?t(Object(n),!0).forEach(function(e){i(r,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})}return r}function i(r,e,t){return(e=function(r){var e=function(r,e){if("object"!=typeof r||!r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"==typeof e?e:e+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}System.register(["./utils-legacy-QV70pBc9.js","./sha2-legacy-Cp5J5zwp.js","./index-legacy-DjG2dD9h.js"],function(e,t){var i,o,a,s,f,u,d,l,h,c,v,w,g,p,y,m,E,b,B,S,x,O,I,R,A,N,q,P,H,z,j,Z,k,F,L,T,C,D,U,V,K,_,Y,M,W,G,J,X,$,Q,rr,er,tr,nr,ir;function or(r,e){var t=r%e;return t>=j?t:e+t}function ar(r,e,t){for(var n=r;e-- >j;)n*=n,n%=t;return n}function sr(r,e){if(r===j)throw new Error("invert: expected non-zero number");if(e<=j)throw new Error("invert: expected positive modulus, got "+e);for(var t=or(r,e),n=e,i=j,o=Z,a=Z,s=j;t!==j;){var f=n/t,u=n%t,d=i-a*f,l=o-s*f;n=t,t=u,i=a,o=s,a=d,s=l}if(n!==Z)throw new Error("invert: does not exist");return or(i,e)}function fr(r,e){var t=(r.ORDER+Z)/L,n=r.pow(e,t);if(!r.eql(r.sqr(n),e))throw new Error("Cannot find square root");return n}function ur(r,e){var t=(r.ORDER-T)/C,n=r.mul(e,k),i=r.pow(n,t),o=r.mul(e,i),a=r.mul(r.mul(o,k),i),s=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(s),e))throw new Error("Cannot find square root");return s}function dr(r){return r%L===F?fr:r%C===T?ur:function(r){if(r<BigInt(3))throw new Error("sqrt is not defined for small field");for(var e=r-Z,t=0;e%k===j;)e/=k,t++;for(var n=k,i=vr(r);1===hr(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===t)return fr;var o=i.pow(n,e),a=(e+Z)/k;return function(r,n){if(r.is0(n))return n;if(1!==hr(r,n))throw new Error("Cannot find square root");for(var i=t,s=r.mul(r.ONE,o),f=r.pow(n,e),u=r.pow(n,a);!r.eql(f,r.ONE);){if(r.is0(f))return r.ZERO;for(var d=1,l=r.sqr(f);!r.eql(l,r.ONE);)if(d++,l=r.sqr(l),d===i)throw new Error("Cannot find square root");var h=Z<<BigInt(i-d-1),c=r.pow(s,h);i=d,s=r.sqr(c),f=r.mul(f,s),u=r.mul(u,c)}return u}}(r)}function lr(r,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Array(e.length).fill(t?r.ZERO:void 0),i=e.reduce((e,t,i)=>r.is0(t)?e:(n[i]=e,r.mul(e,t)),r.ONE),o=r.inv(i);return e.reduceRight((e,t,i)=>r.is0(t)?e:(n[i]=r.mul(e,n[i]),r.mul(e,t)),o),n}function hr(r,e){var t=(r.ORDER-Z)/k,n=r.pow(e,t),i=r.eql(n,r.ONE),o=r.eql(n,r.ZERO),a=r.eql(n,r.neg(r.ONE));if(!i&&!o&&!a)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function cr(r,e){void 0!==e&&x(e);var t=void 0!==e?e:r.toString(2).length;return{nBitLength:t,nByteLength:Math.ceil(t/8)}}function vr(r,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(r<=j)throw new Error("invalid field: expected ORDER > 0, got "+r);var i,o=cr(r,e),a=o.nBitLength,s=o.nByteLength;if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var f=Object.freeze({ORDER:r,isLE:t,BITS:a,BYTES:s,MASK:l(a),ZERO:j,ONE:Z,create:e=>or(e,r),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return j<=e&&e<r},is0:r=>r===j,isOdd:r=>(r&Z)===Z,neg:e=>or(-e,r),eql:(r,e)=>r===e,sqr:e=>or(e*e,r),add:(e,t)=>or(e+t,r),sub:(e,t)=>or(e-t,r),mul:(e,t)=>or(e*t,r),pow:(r,e)=>function(r,e,t){if(t<j)throw new Error("invalid exponent, negatives unsupported");if(t===j)return r.ONE;if(t===Z)return e;for(var n=r.ONE,i=e;t>j;)t&Z&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Z;return n}(f,r,e),div:(e,t)=>or(e*sr(t,r),r),sqrN:r=>r*r,addN:(r,e)=>r+e,subN:(r,e)=>r-e,mulN:(r,e)=>r*e,inv:e=>sr(e,r),sqrt:n.sqrt||(e=>(i||(i=dr(r)),i(f,e))),toBytes:r=>t?u(r,s):d(r,s),fromBytes:r=>{if(r.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+r.length);return t?y(r):w(r)},invertBatch:r=>lr(f,r),cmov:(r,e,t)=>t?e:r});return Object.freeze(f)}function wr(r){if("bigint"!=typeof r)throw new Error("field order must be bigint");var e=r.toString(2).length;return Math.ceil(e/8)}function gr(r){var e=wr(r);return e+Math.ceil(e/2)}function pr(r,e){var t=e.negate();return r?t:e}function yr(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function mr(r,e){yr(r,e);var t=Math.ceil(e/r)+1,n=Math.pow(2,r-1),i=Math.pow(2,r);return{windows:t,windowSize:n,mask:l(r),maxNumber:i,shiftBy:BigInt(r)}}function Er(r,e,t){var n=t.windowSize,i=t.mask,o=t.maxNumber,a=t.shiftBy,s=Number(r&i),f=r>>a;s>n&&(s-=o,f+=V);var u=e*n;return{nextN:f,offset:u+Math.abs(s)-1,isZero:0===s,isNeg:s<0,isNegF:e%2!=0,offsetF:u}}function br(r){return _.get(r)||1}function Br(r,e,t,n){!function(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((r,t)=>{if(!(r instanceof e))throw new Error("invalid point at index "+t)})}(t,r),function(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((r,t)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+t)})}(n,e);var i=t.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");var a=r.ZERO,s=p(BigInt(i)),f=1;s>12?f=s-3:s>4?f=s-2:s>0&&(f=2);for(var u=l(f),d=new Array(Number(u)+1).fill(a),h=a,c=Math.floor((e.BITS-1)/f)*f;c>=0;c-=f){d.fill(a);for(var v=0;v<o;v++){var w=n[v],g=Number(w>>BigInt(c)&u);d[g]=d[g].add(t[v])}for(var y=a,m=d.length-1,E=a;m>0;m--)E=E.add(d[m]),y=y.add(E);if(h=h.add(y),0!==c)for(var b=0;b<f;b++)h=h.double()}return h}function Sr(r){var e,t;return e=r.Fp,t=D.reduce((r,e)=>(r[e]="function",r),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}),b(e,t),b(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(n(n(n({},cr(r.n,r.nBitLength)),r),{},{p:r.Fp.ORDER}))}function xr(r){void 0!==r.lowS&&v("lowS",r.lowS),void 0!==r.prehash&&v("prehash",r.prehash)}function Or(r,e){return o(d(r,e))}function Ir(r){var e=function(r){var e=Sr(r);b(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});var t=e.endo,i=e.Fp,o=e.a;if(t){if(!i.eql(o,i.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof t||"bigint"!=typeof t.beta||"function"!=typeof t.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze(n({},e))}(r),t=e.Fp,i=vr(e.n,e.nBitLength),s=e.toBytes||((r,e,n)=>{var i=e.toAffine();return a(Uint8Array.from([4]),t.toBytes(i.x),t.toBytes(i.y))}),u=e.fromBytes||(r=>{var e=r.subarray(1);return{x:t.fromBytes(e.subarray(0,t.BYTES)),y:t.fromBytes(e.subarray(t.BYTES,2*t.BYTES))}});function d(r){var n=e.a,i=e.b,o=t.sqr(r),a=t.mul(o,r);return t.add(t.add(a,t.mul(r,n)),i)}function l(r,e){var n=t.sqr(e),i=d(r);return t.eql(n,i)}if(!l(e.Gx,e.Gy))throw new Error("bad curve params: generator point");var h=t.mul(t.pow(e.a,J),X),p=t.mul(t.sqr(e.b),BigInt(27));if(t.is0(t.add(h,p)))throw new Error("bad curve params: a or b");function y(r){var t,n=e.allowedPrivateKeyLengths,i=e.nByteLength,a=e.wrapPrivateKey,s=e.n;if(n&&"bigint"!=typeof r){if(g(r)&&(r=o(r)),"string"!=typeof r||!n.includes(r.length))throw new Error("invalid private key");r=r.padStart(2*i,"0")}try{t="bigint"==typeof r?r:w(E("private key",r,i))}catch(f){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+typeof r)}return a&&(t=or(t,s)),m("private key",t,G,s),t}function B(r){if(!(r instanceof O))throw new Error("ProjectivePoint expected")}var S=c((r,e)=>{var n=r.px,i=r.py,o=r.pz;if(t.eql(o,t.ONE))return{x:n,y:i};var a=r.is0();null==e&&(e=a?t.ONE:t.inv(o));var s=t.mul(n,e),f=t.mul(i,e),u=t.mul(o,e);if(a)return{x:t.ZERO,y:t.ZERO};if(!t.eql(u,t.ONE))throw new Error("invZ was invalid");return{x:s,y:f}}),x=c(r=>{if(r.is0()){if(e.allowInfinityPoint&&!t.is0(r.py))return;throw new Error("bad point: ZERO")}var n=r.toAffine(),i=n.x,o=n.y;if(!t.isValid(i)||!t.isValid(o))throw new Error("bad point: x or y not FE");if(!l(i,o))throw new Error("bad point: equation left != right");if(!r.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class O{constructor(r,e,n){if(null==r||!t.isValid(r))throw new Error("x required");if(null==e||!t.isValid(e)||t.is0(e))throw new Error("y required");if(null==n||!t.isValid(n))throw new Error("z required");this.px=r,this.py=e,this.pz=n,Object.freeze(this)}static fromAffine(r){var e=r||{},n=e.x,i=e.y;if(!r||!t.isValid(n)||!t.isValid(i))throw new Error("invalid affine point");if(r instanceof O)throw new Error("projective point not allowed");var o=r=>t.eql(r,t.ZERO);return o(n)&&o(i)?O.ZERO:new O(n,i,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(r){var e=lr(t,r.map(r=>r.pz));return r.map((r,t)=>r.toAffine(e[t])).map(O.fromAffine)}static fromHex(r){var e=O.fromAffine(u(E("pointHex",r)));return e.assertValidity(),e}static fromPrivateKey(r){return O.BASE.multiply(y(r))}static msm(r,e){return Br(O,i,r,e)}_setWindowSize(r){q.setWindowSize(this,r)}assertValidity(){x(this)}hasEvenY(){var r=this.toAffine().y;if(t.isOdd)return!t.isOdd(r);throw new Error("Field doesn't support isOdd")}equals(r){B(r);var e=this.px,n=this.py,i=this.pz,o=r.px,a=r.py,s=r.pz,f=t.eql(t.mul(e,s),t.mul(o,i)),u=t.eql(t.mul(n,s),t.mul(a,i));return f&&u}negate(){return new O(this.px,t.neg(this.py),this.pz)}double(){var r=e.a,n=e.b,i=t.mul(n,J),o=this.px,a=this.py,s=this.pz,f=t.ZERO,u=t.ZERO,d=t.ZERO,l=t.mul(o,o),h=t.mul(a,a),c=t.mul(s,s),v=t.mul(o,a);return v=t.add(v,v),d=t.mul(o,s),d=t.add(d,d),f=t.mul(r,d),u=t.mul(i,c),u=t.add(f,u),f=t.sub(h,u),u=t.add(h,u),u=t.mul(f,u),f=t.mul(v,f),d=t.mul(i,d),c=t.mul(r,c),v=t.sub(l,c),v=t.mul(r,v),v=t.add(v,d),d=t.add(l,l),l=t.add(d,l),l=t.add(l,c),l=t.mul(l,v),u=t.add(u,l),c=t.mul(a,s),c=t.add(c,c),l=t.mul(c,v),f=t.sub(f,l),d=t.mul(c,h),d=t.add(d,d),d=t.add(d,d),new O(f,u,d)}add(r){B(r);var n=this.px,i=this.py,o=this.pz,a=r.px,s=r.py,f=r.pz,u=t.ZERO,d=t.ZERO,l=t.ZERO,h=e.a,c=t.mul(e.b,J),v=t.mul(n,a),w=t.mul(i,s),g=t.mul(o,f),p=t.add(n,i),y=t.add(a,s);p=t.mul(p,y),y=t.add(v,w),p=t.sub(p,y),y=t.add(n,o);var m=t.add(a,f);return y=t.mul(y,m),m=t.add(v,g),y=t.sub(y,m),m=t.add(i,o),u=t.add(s,f),m=t.mul(m,u),u=t.add(w,g),m=t.sub(m,u),l=t.mul(h,y),u=t.mul(c,g),l=t.add(u,l),u=t.sub(w,l),l=t.add(w,l),d=t.mul(u,l),w=t.add(v,v),w=t.add(w,v),g=t.mul(h,g),y=t.mul(c,y),w=t.add(w,g),g=t.sub(v,g),g=t.mul(h,g),y=t.add(y,g),v=t.mul(w,y),d=t.add(d,v),v=t.mul(m,y),u=t.mul(p,u),u=t.sub(u,v),v=t.mul(p,w),l=t.mul(m,l),l=t.add(l,v),new O(u,d,l)}subtract(r){return this.add(r.negate())}is0(){return this.equals(O.ZERO)}wNAF(r){return q.wNAFCached(this,r,O.normalizeZ)}multiplyUnsafe(r){var n=e.endo,i=e.n;m("scalar",r,W,i);var o=O.ZERO;if(r===W)return o;if(this.is0()||r===G)return this;if(!n||q.hasPrecomputes(this))return q.wNAFCachedUnsafe(this,r,O.normalizeZ);for(var a=n.splitScalar(r),s=a.k1neg,f=a.k1,u=a.k2neg,d=a.k2,l=o,h=o,c=this;f>W||d>W;)f&G&&(l=l.add(c)),d&G&&(h=h.add(c)),c=c.double(),f>>=G,d>>=G;return s&&(l=l.negate()),u&&(h=h.negate()),h=new O(t.mul(h.px,n.beta),h.py,h.pz),l.add(h)}multiply(r){var n,i,o=e.endo,a=e.n;if(m("scalar",r,G,a),o){var s=o.splitScalar(r),f=s.k1neg,u=s.k1,d=s.k2neg,l=s.k2,h=this.wNAF(u),c=h.p,v=h.f,w=this.wNAF(l),g=w.p,p=w.f;c=q.constTimeNegate(f,c),g=q.constTimeNegate(d,g),g=new O(t.mul(g.px,o.beta),g.py,g.pz),n=c.add(g),i=v.add(p)}else{var y=this.wNAF(r);n=y.p,i=y.f}return O.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(r,e,t){var n=O.BASE,i=(r,e)=>e!==W&&e!==G&&r.equals(n)?r.multiply(e):r.multiplyUnsafe(e),o=i(this,e).add(i(r,t));return o.is0()?void 0:o}toAffine(r){return S(this,r)}isTorsionFree(){var r=e.h,t=e.isTorsionFree;if(r===G)return!0;if(t)return t(O,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){var r=e.h,t=e.clearCofactor;return r===G?this:t?t(O,this):this.multiplyUnsafe(e.h)}toRawBytes(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return v("isCompressed",r),this.assertValidity(),s(O,this,r)}toHex(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return v("isCompressed",r),o(this.toRawBytes(r))}}O.BASE=new O(e.Gx,e.Gy,t.ONE),O.ZERO=new O(t.ZERO,t.ONE,t.ZERO);var I,R,A=e.endo,N=e.nBitLength,q=(I=O,R=A?Math.ceil(N/2):N,{constTimeNegate:pr,hasPrecomputes:r=>1!==br(r),unsafeLadder(r,e){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I.ZERO,n=r;e>U;)e&V&&(t=t.add(n)),n=n.double(),e>>=V;return t},precomputeWindow(r,e){for(var t=mr(e,R),n=t.windows,i=t.windowSize,o=[],a=r,s=a,f=0;f<n;f++){s=a,o.push(s);for(var u=1;u<i;u++)s=s.add(a),o.push(s);a=s.double()}return o},wNAF(r,e,t){for(var n=I.ZERO,i=I.BASE,o=mr(r,R),a=0;a<o.windows;a++){var s=Er(t,a,o),f=s.nextN,u=s.offset,d=s.isZero,l=s.isNeg,h=s.isNegF,c=s.offsetF;t=f,d?i=i.add(pr(h,e[c])):n=n.add(pr(l,e[u]))}return{p:n,f:i}},wNAFUnsafe(r,e,t){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I.ZERO,i=mr(r,R),o=0;o<i.windows&&t!==U;o++){var a=Er(t,o,i),s=a.nextN,f=a.offset,u=a.isZero,d=a.isNeg;if(t=s,!u){var l=e[f];n=n.add(d?l.negate():l)}}return n},getPrecomputes(r,e,t){var n=K.get(e);return n||(n=this.precomputeWindow(e,r),1!==r&&K.set(e,t(n))),n},wNAFCached(r,e,t){var n=br(r);return this.wNAF(n,this.getPrecomputes(n,r,t),e)},wNAFCachedUnsafe(r,e,t,n){var i=br(r);return 1===i?this.unsafeLadder(r,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,r,t),e,n)},setWindowSize(r,e){yr(e,R),_.set(r,e),K.delete(r)}});return{CURVE:e,ProjectivePoint:O,normPrivateKeyToScalar:y,weierstrassEquation:d,isWithinCurveOrder:function(r){return f(r,G,e.n)}}}function Rr(r){var e,t=(e=Sr(r),b(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(n({lowS:!0},e))),i=t.Fp,o=t.n,c=t.nByteLength,p=t.nBitLength,B=i.BYTES+1,S=2*i.BYTES+1;function x(r){return or(r,o)}function O(r){return sr(r,o)}var I=Ir(n(n({},t),{},{toBytes(r,e,t){var n=e.toAffine(),o=i.toBytes(n.x),s=a;return v("isCompressed",t),t?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,i.toBytes(n.y))},fromBytes(r){var e=r.length,t=r[0],n=r.subarray(1);if(e!==B||2!==t&&3!==t){if(e===S&&4===t)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw new Error("invalid Point, expected length of "+B+", or uncompressed "+S+", got "+e)}var o=w(n);if(!f(o,G,i.ORDER))throw new Error("Point is not on curve");var a,s=N(o);try{a=i.sqrt(s)}catch(d){var u=d instanceof Error?": "+d.message:"";throw new Error("Point is not on curve"+u)}return!(1&~t)!==((a&G)===G)&&(a=i.neg(a)),{x:o,y:a}}})),R=I.ProjectivePoint,A=I.normPrivateKeyToScalar,N=I.weierstrassEquation,q=I.isWithinCurveOrder;function P(r){return r>o>>G}var H=(r,e,t)=>w(r.slice(e,t));class z{constructor(r,e,t){m("r",r,G,o),m("s",e,G,o),this.r=r,this.s=e,null!=t&&(this.recovery=t),Object.freeze(this)}static fromCompact(r){var e=c;return r=E("compactSignature",r,2*e),new z(H(r,0,e),H(r,e,2*e))}static fromDER(r){var e=M.toSig(E("DER",r)),t=e.r,n=e.s;return new z(t,n)}assertValidity(){}addRecoveryBit(r){return new z(this.r,this.s,r)}recoverPublicKey(r){var e=this.r,n=this.s,o=this.recovery,a=L(E("msgHash",r));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var s=2===o||3===o?e+t.n:e;if(s>=i.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=1&o?"03":"02",u=R.fromHex(f+Or(s,i.BYTES)),d=O(s),l=x(-a*d),h=x(n*d),c=R.BASE.multiplyAndAddUnsafe(u,l,h);if(!c)throw new Error("point at infinify");return c.assertValidity(),c}hasHighS(){return P(this.s)}normalizeS(){return this.hasHighS()?new z(this.r,x(-this.s),this.recovery):this}toDERRawBytes(){return s(this.toDERHex())}toDERHex(){return M.hexFromSig(this)}toCompactRawBytes(){return s(this.toCompactHex())}toCompactHex(){var r=c;return Or(this.r,r)+Or(this.s,r)}}var j={isValidPrivateKey(r){try{return A(r),!0}catch(e){return!1}},normPrivateKeyToScalar:A,randomPrivateKey:()=>{var r=gr(t.n);return function(r,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r.length,i=wr(e),o=gr(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);var a=or(t?y(r):w(r),e-Z)+Z;return t?u(a,i):d(a,i)}(t.randomBytes(r),t.n)},precompute(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R.BASE;return e._setWindowSize(r),e.multiply(BigInt(3)),e}};function k(r){if("bigint"==typeof r)return!1;if(r instanceof R)return!0;var e=E("key",r).length,n=i.BYTES,o=n+1,a=2*n+1;return t.allowedPrivateKeyLengths||c===o?void 0:e===o||e===a}var F=t.bits2int||function(r){if(r.length>8192)throw new Error("input is too large");var e=w(r),t=8*r.length-p;return t>0?e>>BigInt(t):e},L=t.bits2int_modN||function(r){return x(F(r))},T=l(p);function C(r){return m("num < 2^"+p,r,W,T),d(r,c)}function D(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;if(["recovered","canonical"].some(r=>r in n))throw new Error("sign() legacy options not supported");var o=t.hash,s=t.randomBytes,f=n.lowS,u=n.prehash,d=n.extraEntropy;null==f&&(f=!0),r=E("msgHash",r),xr(n),u&&(r=E("prehashed msgHash",o(r)));var l=L(r),h=A(e),c=[C(h),C(l)];if(null!=d&&!1!==d){var v=!0===d?s(i.BYTES):d;c.push(E("extraEntropy",v))}var w=a(...c),g=l;return{seed:w,k2sig:function(r){var e=F(r);if(q(e)){var t=O(e),n=R.BASE.multiply(e).toAffine(),i=x(n.x);if(i!==W){var o=x(t*x(g+i*h));if(o!==W){var a=(n.x===i?0:2)|Number(n.y&G),s=o;return f&&P(o)&&(s=function(r){return P(r)?x(-r):r}(o),a^=1),new z(i,s,a)}}}}}}var U={lowS:t.lowS,prehash:!1},V={lowS:t.lowS,prehash:!1};return R.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(r){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return R.fromPrivateKey(r).toRawBytes(e)},getSharedSecret:function(r,e){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0===k(r))throw new Error("first arg must be private key");if(!1===k(e))throw new Error("second arg must be public key");return R.fromHex(e).multiply(A(r)).toRawBytes(t)},sign:function(r,e){var n=D(r,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:U),i=n.seed,o=n.k2sig,a=t;return h(a.hash.outputLen,a.nByteLength,a.hmac)(i,o)},verify:function(r,e,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:V,a=r;e=E("msgHash",e),n=E("publicKey",n);var s=o.lowS,f=o.prehash,u=o.format;if(xr(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw new Error("format must be compact or der");var d="string"==typeof a||g(a),l=!d&&!u&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!d&&!l)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");var h,c=void 0;try{if(l&&(c=new z(a.r,a.s)),d){try{"compact"!==u&&(c=z.fromDER(a))}catch(I){if(!(I instanceof M.Err))throw I}c||"der"===u||(c=z.fromCompact(a))}h=R.fromHex(n)}catch(A){return!1}if(!c)return!1;if(s&&c.hasHighS())return!1;f&&(e=t.hash(e));var v=c,w=v.r,p=v.s,y=L(e),m=O(p),b=x(y*m),B=x(w*m),S=null===(i=R.BASE.multiplyAndAddUnsafe(h,b,B))||void 0===i?void 0:i.toAffine();return!!S&&x(S.x)===w},ProjectivePoint:R,Signature:z,utils:j}}function Ar(r,e){var t=e=>Rr(n(n({},r),function(r){return{hash:r,hmac:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return z(r,e,A(...n))},randomBytes:N}}(e)));return n(n({},t(e)),{},{create:t})}function Nr(r){var e=$,t=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),s=BigInt(44),f=BigInt(88),u=r*r*r%e,d=u*u*r%e,l=ar(d,t,e)*d%e,h=ar(l,t,e)*d%e,c=ar(h,tr,e)*u%e,v=ar(c,i,e)*c%e,w=ar(v,o,e)*v%e,g=ar(w,s,e)*w%e,p=ar(g,f,e)*g%e,y=ar(p,s,e)*w%e,m=ar(y,t,e)*d%e,E=ar(m,a,e)*v%e,b=ar(E,n,e)*u%e,B=ar(b,tr,e);if(!ir.eql(ir.sqr(B),r))throw new Error("Cannot find square root");return B}return{setters:[function(r){i=r._,o=r.a,a=r.c,s=r.d,f=r.f,u=r.g,d=r.h,l=r.i,h=r.l,c=r.m,v=r.n,w=r.o,g=r.p,p=r.r,y=r.s,m=r.t,E=r.u,b=r.v},function(r){B=r.t},function(r){S=r.G,x=r.J,O=r.K,I=r.W,R=r.X,A=r.Z,N=r.et,q=r.nt,P=r.q}],execute:function(){H=class extends I{constructor(r,e){super(),this.finished=!1,this.destroyed=!1,P(r);var t=q(e);if(this.iHash=r.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;var n=this.blockLen,i=new Uint8Array(n);i.set(t.length>n?r.create().update(t).digest():t);for(var o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=r.create();for(var a=0;a<i.length;a++)i[a]^=106;this.oHash.update(i),R(i)}update(r){return O(this),this.iHash.update(r),this}digestInto(r){O(this),S(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){var r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));var e=this.oHash,t=this.iHash,n=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return r.finished=n,r.destroyed=i,r.blockLen=o,r.outputLen=a,r.oHash=e._cloneInto(r.oHash),r.iHash=t._cloneInto(r.iHash),r}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},(z=(r,e,t)=>new H(r,e).update(t).digest()).create=(r,e)=>new H(r,e),j=BigInt(0),Z=BigInt(1),k=BigInt(2),F=BigInt(3),L=BigInt(4),T=BigInt(5),C=BigInt(8),D=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"],U=BigInt(0),V=BigInt(1),K=new WeakMap,_=new WeakMap,Y=class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},M={Err:Y,_tlv:{encode:(r,e)=>{var t=M.Err;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(1&e.length)throw new t("tlv.encode: unpadded data");var n=e.length/2,o=i(n);if(o.length/2&128)throw new t("tlv.encode: long form length too big");var a=n>127?i(o.length/2|128):"";return i(r)+a+o+e},decode(e,t){var n=M.Err,i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new n("tlv.decode: wrong tlv");var o=t[i++],a=0;if(!!(128&o)){var s=127&o;if(!s)throw new n("tlv.decode(long): indefinite length not supported");if(s>4)throw new n("tlv.decode(long): byte length is too big");var f=t.subarray(i,i+s);if(f.length!==s)throw new n("tlv.decode: length bytes not complete");if(0===f[0])throw new n("tlv.decode(long): zero leftmost byte");var u,d=r(f);try{for(d.s();!(u=d.n()).done;){a=a<<8|u.value}}catch(h){d.e(h)}finally{d.f()}if(i+=s,a<128)throw new n("tlv.decode(long): not minimal encoding")}else a=o;var l=t.subarray(i,i+a);if(l.length!==a)throw new n("tlv.decode: wrong value length");return{v:l,l:t.subarray(i+a)}}},_int:{encode(r){var e=M.Err;if(r<W)throw new e("integer: negative integers are not allowed");var t=i(r);if(8&Number.parseInt(t[0],16)&&(t="00"+t),1&t.length)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){var e=M.Err;if(128&r[0])throw new e("invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("invalid signature integer: unnecessary leading zero");return w(r)}},toSig(r){var e=M,t=e.Err,n=e._int,i=e._tlv,o=E("signature",r),a=i.decode(48,o),s=a.v;if(a.l.length)throw new t("invalid signature: left bytes after parsing");var f=i.decode(2,s),u=f.v,d=f.l,l=i.decode(2,d),h=l.v;if(l.l.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(u),s:n.decode(h)}},hexFromSig(r){var e=M,t=e._tlv,n=e._int,i=t.encode(2,n.encode(r.r))+t.encode(2,n.encode(r.s));return t.encode(48,i)}},W=BigInt(0),G=BigInt(1),BigInt(2),J=BigInt(3),X=BigInt(4),$=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Q=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),rr=BigInt(0),er=BigInt(1),tr=BigInt(2),nr=(r,e)=>(r+e/tr)/e,ir=vr($,void 0,void 0,{sqrt:Nr}),e("secp256k1",Ar({a:rr,b:BigInt(7),Fp:ir,n:Q,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{var e=Q,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-er*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,a=BigInt("0x100000000000000000000000000000000"),s=nr(o*r,e),f=nr(-n*r,e),u=or(r-s*t-f*i,e),d=or(-s*n-f*o,e),l=u>a,h=d>a;if(l&&(u=e-u),h&&(d=e-d),u>a||d>a)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:u,k2neg:h,k2:d}}}},B))}}})}();